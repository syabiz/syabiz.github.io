<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bitcoin Batch Wallet Checker</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@300;400;500;600;700&display=swap');

:root {
  --bg:        #080b10;
  --bg2:       #0d1117;
  --bg3:       #131920;
  --border:    #1e2d3d;
  --border2:   #243444;
  --accent:    #f7931a;
  --accent2:   #ffa940;
  --accentd:   #c4721200;
  --text:      #cdd9e5;
  --muted:     #5c7080;
  --muted2:    #8898a8;
  --green:     #3fb950;
  --red:       #f85149;
  --yellow:    #d29922;
  --blue:      #58a6ff;
  --mono:      'IBM Plex Mono', monospace;
  --sans:      'IBM Plex Sans', sans-serif;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { scroll-behavior: smooth; }

body {
  font-family: var(--sans);
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* â”€â”€ GRID SCANLINE BACKGROUND â”€â”€ */
body::before {
  content: '';
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background-image:
    linear-gradient(rgba(247,147,26,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(247,147,26,0.03) 1px, transparent 1px);
  background-size: 40px 40px;
}
body::after {
  content: '';
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background: radial-gradient(ellipse 70% 60% at 50% 0%, rgba(247,147,26,0.08) 0%, transparent 55%);
}

.wrap {
  max-width: 1100px;
  margin: 0 auto;
  padding: 32px 20px 60px;
  position: relative; z-index: 1;
}

/* â”€â”€ HEADER â”€â”€ */
.header {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 36px;
  padding-bottom: 24px;
  border-bottom: 1px solid var(--border);
}
.btc-logo {
  width: 52px; height: 52px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  border-radius: 14px;
  display: flex; align-items: center; justify-content: center;
  font-family: var(--mono); font-size: 22px; font-weight: 600; color: #000;
  box-shadow: 0 0 28px rgba(247,147,26,0.35), inset 0 1px 0 rgba(255,255,255,0.2);
  flex-shrink: 0;
}
.header-text h1 {
  font-size: 1.5rem; font-weight: 700; letter-spacing: -0.02em;
  background: linear-gradient(90deg, #fff 0%, var(--accent2) 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.header-text p {
  font-size: 0.8rem; color: var(--muted); margin-top: 3px; font-family: var(--mono);
}
.header-badge {
  margin-left: auto;
  background: rgba(247,147,26,0.1);
  border: 1px solid rgba(247,147,26,0.25);
  border-radius: 6px;
  padding: 4px 10px;
  font-size: 0.72rem;
  font-family: var(--mono);
  color: var(--accent2);
  white-space: nowrap;
}

/* â”€â”€ TABS â”€â”€ */
.tabs {
  display: flex; gap: 4px;
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 4px;
  margin-bottom: 24px;
}
.tab-btn {
  flex: 1; padding: 9px 16px;
  background: none; border: none; cursor: pointer;
  font-family: var(--sans); font-size: 0.82rem; font-weight: 500;
  color: var(--muted); border-radius: 7px;
  transition: all 0.2s;
}
.tab-btn.active {
  background: var(--bg3);
  color: var(--text);
  box-shadow: 0 1px 3px rgba(0,0,0,0.4);
}
.tab-btn:hover:not(.active) { color: var(--text); }

.tab-panel { display: none; }
.tab-panel.active { display: block; }

/* â”€â”€ LAYOUT 2 KOLOM â”€â”€ */
.two-col {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  margin-bottom: 16px;
}
@media (max-width: 700px) { .two-col { grid-template-columns: 1fr; } }

/* â”€â”€ CARD â”€â”€ */
.card {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 12px;
  overflow: hidden;
}
.card-head {
  display: flex; align-items: center; justify-content: space-between;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border);
  background: var(--bg3);
}
.card-head-title {
  font-size: 0.78rem; font-weight: 600;
  text-transform: uppercase; letter-spacing: 0.08em;
  color: var(--muted2);
  display: flex; align-items: center; gap: 8px;
}
.card-head-title .dot {
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--accent);
}
.card-body { padding: 0; }

textarea.input-area {
  width: 100%; height: 220px;
  background: transparent;
  border: none; outline: none;
  padding: 14px 16px;
  font-family: var(--mono); font-size: 0.76rem;
  color: var(--text); line-height: 1.7;
  resize: none;
}
textarea.input-area::placeholder { color: var(--muted); }
textarea.input-area:focus { background: rgba(247,147,26,0.02); }

.card-foot {
  padding: 8px 12px;
  border-top: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
}
.count-badge {
  font-family: var(--mono); font-size: 0.72rem; color: var(--muted);
}
.count-badge span { color: var(--accent); font-weight: 600; }

.btn-sm {
  background: var(--bg3); border: 1px solid var(--border2);
  color: var(--muted2); border-radius: 5px; padding: 4px 10px;
  font-family: var(--sans); font-size: 0.72rem; cursor: pointer;
  transition: all 0.15s;
}
.btn-sm:hover { border-color: var(--accent); color: var(--accent); }

/* â”€â”€ OPTIONS ROW â”€â”€ */
.options-row {
  display: flex; gap: 12px; align-items: center;
  margin-bottom: 16px; flex-wrap: wrap;
}
.opt-group {
  display: flex; align-items: center; gap: 8px;
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: 8px; padding: 8px 14px;
}
.opt-label { font-size: 0.78rem; color: var(--muted); }
.opt-select {
  background: var(--bg3); border: 1px solid var(--border2);
  color: var(--text); border-radius: 5px; padding: 3px 8px;
  font-family: var(--mono); font-size: 0.75rem;
  outline: none; cursor: pointer;
}
.opt-select:focus { border-color: var(--accent); }

/* â”€â”€ ACTION BUTTONS â”€â”€ */
.action-row {
  display: flex; gap: 10px; margin-bottom: 24px; flex-wrap: wrap;
}
.btn-primary {
  padding: 12px 28px;
  background: linear-gradient(135deg, var(--accent) 0%, var(--accent2) 100%);
  color: #000; border: none; border-radius: 8px;
  font-family: var(--sans); font-size: 0.88rem; font-weight: 700;
  cursor: pointer; letter-spacing: 0.04em;
  box-shadow: 0 4px 20px rgba(247,147,26,0.3);
  transition: all 0.2s;
  display: flex; align-items: center; gap: 8px;
}
.btn-primary:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 8px 28px rgba(247,147,26,0.45);
}
.btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

.btn-secondary {
  padding: 12px 20px;
  background: var(--bg2); border: 1px solid var(--border2);
  color: var(--text); border-radius: 8px;
  font-family: var(--sans); font-size: 0.85rem; font-weight: 500;
  cursor: pointer; transition: all 0.15s;
}
.btn-secondary:hover { border-color: var(--accent); color: var(--accent); }
.btn-secondary:disabled { opacity: 0.4; cursor: not-allowed; }

/* â”€â”€ PROGRESS â”€â”€ */
.progress-section { display: none; margin-bottom: 20px; }
.progress-section.visible { display: block; }

.progress-header {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 8px;
}
.progress-title { font-size: 0.8rem; color: var(--muted2); font-family: var(--mono); }
.progress-pct { font-size: 0.8rem; color: var(--accent); font-family: var(--mono); font-weight: 600; }

.progress-bar-bg {
  height: 6px; background: var(--bg3); border-radius: 3px; overflow: hidden;
}
.progress-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  border-radius: 3px;
  transition: width 0.3s ease;
  width: 0%;
}

.progress-stats {
  display: flex; gap: 20px; margin-top: 10px; flex-wrap: wrap;
}
.pstat {
  font-family: var(--mono); font-size: 0.75rem;
  display: flex; align-items: center; gap: 6px;
}
.pstat .num { font-weight: 600; }
.pstat.found .num { color: var(--green); }
.pstat.checked .num { color: var(--blue); }
.pstat.remain .num { color: var(--muted2); }
.pstat.speed .num { color: var(--yellow); }
.pstat.eta .num { color: var(--muted2); }

/* â”€â”€ LOG / RESULTS TABLE â”€â”€ */
.results-section { display: none; }
.results-section.visible { display: block; }

.results-toolbar {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 10px; flex-wrap: wrap; gap: 8px;
}
.results-title { font-size: 0.78rem; font-weight: 600; text-transform: uppercase;
  letter-spacing: 0.08em; color: var(--muted2); }

.filter-row { display: flex; gap: 6px; }
.filter-btn {
  padding: 4px 10px; border-radius: 5px;
  background: var(--bg3); border: 1px solid var(--border);
  color: var(--muted); font-size: 0.72rem; font-family: var(--mono);
  cursor: pointer; transition: all 0.15s;
}
.filter-btn.active { background: rgba(247,147,26,0.12); border-color: var(--accent); color: var(--accent); }

.results-table-wrap {
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: 10px; overflow: hidden;
  max-height: 420px; overflow-y: auto;
}
.results-table-wrap::-webkit-scrollbar { width: 6px; }
.results-table-wrap::-webkit-scrollbar-track { background: var(--bg3); }
.results-table-wrap::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }

table { width: 100%; border-collapse: collapse; }
thead th {
  background: var(--bg3); padding: 10px 14px;
  font-size: 0.7rem; font-weight: 600; text-transform: uppercase;
  letter-spacing: 0.08em; color: var(--muted);
  text-align: left; border-bottom: 1px solid var(--border);
  position: sticky; top: 0; z-index: 2;
}
tbody tr { border-bottom: 1px solid rgba(30,45,61,0.6); transition: background 0.1s; }
tbody tr:hover { background: rgba(247,147,26,0.03); }
tbody tr:last-child { border-bottom: none; }
tbody td {
  padding: 9px 14px; font-size: 0.75rem; font-family: var(--mono);
  vertical-align: middle;
}
.td-status { width: 80px; }
.status-pill {
  display: inline-flex; align-items: center; gap: 5px;
  padding: 3px 8px; border-radius: 4px;
  font-size: 0.68rem; font-weight: 600; letter-spacing: 0.05em;
}
.status-pill.found { background: rgba(63,185,80,0.12); color: var(--green); border: 1px solid rgba(63,185,80,0.2); }
.status-pill.failed { background: rgba(248,81,73,0.08); color: var(--red); border: 1px solid rgba(248,81,73,0.15); }
.status-pill.error { background: rgba(210,153,34,0.1); color: var(--yellow); border: 1px solid rgba(210,153,34,0.2); }
.status-pill.checking { background: rgba(88,166,255,0.08); color: var(--blue); border: 1px solid rgba(88,166,255,0.15); }

.td-hash { max-width: 260px; }
.hash-short {
  color: var(--muted2); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
  max-width: 240px; display: block;
}
.td-password { color: var(--green); font-weight: 600; }
.td-time { color: var(--muted); text-align: right; }

/* â”€â”€ LIVE LOG â”€â”€ */
.log-section { margin-top: 16px; }
.log-box {
  background: #050810;
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 12px 14px;
  height: 120px; overflow-y: auto;
  font-family: var(--mono); font-size: 0.7rem;
  line-height: 1.8; color: var(--muted);
}
.log-box::-webkit-scrollbar { width: 4px; }
.log-box::-webkit-scrollbar-thumb { background: var(--border2); }
.log-line { white-space: nowrap; }
.log-line.found { color: var(--green); }
.log-line.fail  { color: var(--muted); }
.log-line.info  { color: var(--blue); }
.log-line.warn  { color: var(--yellow); }

/* â”€â”€ SUMMARY CARDS â”€â”€ */
.summary-grid {
  display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;
  margin-bottom: 20px; display: none;
}
.summary-grid.visible { display: grid; }
@media (max-width: 600px) { .summary-grid { grid-template-columns: repeat(2,1fr); } }

.scard {
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: 10px; padding: 14px 16px;
  position: relative; overflow: hidden;
}
.scard::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
}
.scard.s-found::before { background: var(--green); }
.scard.s-fail::before  { background: var(--red); }
.scard.s-total::before { background: var(--blue); }
.scard.s-speed::before { background: var(--accent); }

.scard-val {
  font-size: 1.6rem; font-weight: 700; font-family: var(--mono);
  margin-bottom: 4px;
}
.scard.s-found .scard-val { color: var(--green); }
.scard.s-fail  .scard-val { color: var(--red); }
.scard.s-total .scard-val { color: var(--blue); }
.scard.s-speed .scard-val { color: var(--accent); }
.scard-label { font-size: 0.72rem; color: var(--muted); text-transform: uppercase; letter-spacing: 0.06em; }

/* â”€â”€ EXPORT BTN â”€â”€ */
.export-row { display: flex; gap: 8px; margin-top: 12px; }
.btn-export {
  padding: 8px 16px; background: var(--bg3);
  border: 1px solid var(--border2); border-radius: 6px;
  color: var(--muted2); font-family: var(--sans); font-size: 0.78rem;
  cursor: pointer; transition: all 0.15s;
  display: flex; align-items: center; gap: 6px;
}
.btn-export:hover { border-color: var(--green); color: var(--green); }

/* â”€â”€ SINGLE CHECK TAB â”€â”€ */
.single-form { padding: 20px; }
.form-row { margin-bottom: 18px; }
.form-label {
  display: block; font-size: 0.75rem; font-weight: 600;
  text-transform: uppercase; letter-spacing: 0.08em;
  color: var(--muted); margin-bottom: 8px;
}
.form-input, .form-textarea {
  width: 100%; background: var(--bg3); border: 1px solid var(--border);
  border-radius: 8px; padding: 11px 14px;
  font-family: var(--mono); font-size: 0.8rem; color: var(--text);
  outline: none; transition: border-color 0.2s;
}
.form-input:focus, .form-textarea:focus {
  border-color: rgba(247,147,26,0.5);
  box-shadow: 0 0 0 3px rgba(247,147,26,0.07);
}
.form-textarea { resize: vertical; }
.pw-row { position: relative; }
.pw-row .form-input { padding-right: 44px; }
.pw-eye {
  position: absolute; right: 12px; top: 50%; transform: translateY(-50%);
  background: none; border: none; cursor: pointer; color: var(--muted);
  font-size: 1rem; padding: 4px; transition: color 0.15s; width: auto;
}
.pw-eye:hover { color: var(--accent); }

.single-result { display: none; margin-top: 20px; border-radius: 10px; padding: 20px 24px; border: 1px solid; }
.single-result.success { background: rgba(63,185,80,0.06); border-color: rgba(63,185,80,0.2); }
.single-result.error   { background: rgba(248,81,73,0.06); border-color: rgba(248,81,73,0.2); }
.single-result.warning { background: rgba(210,153,34,0.06); border-color: rgba(210,153,34,0.2); }
.result-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 6px; }
.single-result.success .result-title { color: var(--green); }
.single-result.error   .result-title { color: var(--red); }
.single-result.warning .result-title { color: var(--yellow); }
.result-msg { font-size: 0.82rem; color: var(--muted2); }
.debug-toggle-btn {
  margin-top: 12px; background: none; border: 1px solid var(--border);
  color: var(--muted); border-radius: 5px; padding: 5px 12px;
  font-size: 0.75rem; cursor: pointer; font-family: var(--sans); width: auto;
  transition: all 0.15s;
}
.debug-toggle-btn:hover { border-color: var(--accent); color: var(--accent); }
.debug-pre {
  display: none; margin-top: 12px;
  background: #030609; border: 1px solid var(--border);
  border-radius: 8px; padding: 14px; font-family: var(--mono);
  font-size: 0.7rem; color: #58a6ff; white-space: pre-wrap;
  word-break: break-all; line-height: 1.7;
}

/* â”€â”€ SPINNER â”€â”€ */
.spinner {
  width: 16px; height: 16px;
  border: 2px solid rgba(0,0,0,0.3);
  border-top-color: #000;
  border-radius: 50%;
  animation: spin 0.6s linear infinite;
  display: none;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* â”€â”€ SCROLLBAR GLOBAL â”€â”€ */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: var(--bg2); }
::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }
</style>
</head>
<body>
<div class="wrap">

  <!-- HEADER -->
  <div class="header">
    <div class="btc-logo">â‚¿</div>
    <div class="header-text">
      <h1>Bitcoin Batch Wallet Checker</h1>
      <p>SHA-512 Iterative Â· AES-256-CBC Â· PKCS7 Â· HashCat -m 11300</p>
    </div>
    <div class="header-badge">v2.0 BATCH</div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <button class="tab-btn active" onclick="switchTab('batch')">âš¡ Batch Checker</button>
    <button class="tab-btn" onclick="switchTab('single')">ğŸ” Single Check</button>
    <button class="tab-btn" onclick="switchTab('guide')">ğŸ“– Guide</button>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TAB: BATCH
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tab-batch" class="tab-panel active">

    <!-- Input Area -->
    <div class="two-col">
      <!-- Hash List -->
      <div class="card">
        <div class="card-head">
          <div class="card-head-title"><span class="dot"></span> Hash List</div>
          <button class="btn-sm" onclick="loadSampleHashes()">Sample</button>
        </div>
        <div class="card-body">
          <textarea id="hashList" class="input-area"
            placeholder="Masukkan one hash per line:&#10;$bitcoin$64$abc...&#10;$bitcoin$64$def...&#10;$litecoin$64$ghi..."></textarea>
        </div>
        <div class="card-foot">
          <span class="count-badge">Valid hashes: <span id="hashCount">0</span></span>
          <button class="btn-sm" onclick="clearHashes()">Clear</button>
        </div>
      </div>

      <!-- Wordlist -->
      <div class="card">
        <div class="card-head">
          <div class="card-head-title"><span class="dot"></span> Password Wordlist</div>
          <button class="btn-sm" onclick="loadSampleWords()">Sample</button>
        </div>
        <div class="card-body">
          <textarea id="wordList" class="input-area"
            placeholder="Masukkan one password per line:&#10;password123&#10;bitcoin2024&#10;1234567890&#10;..."></textarea>
        </div>
        <div class="card-foot">
          <span class="count-badge">Passwords: <span id="wordCount">0</span></span>
          <div style="display:flex;gap:6px">
            <label class="btn-sm" style="cursor:pointer">
              Upload .txt
              <input type="file" accept=".txt" style="display:none" onchange="loadWordlistFile(event)">
            </label>
            <button class="btn-sm" onclick="clearWords()">Clear</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Options -->
    <div class="options-row">
      <div class="opt-group">
        <span class="opt-label">Mode:</span>
        <select id="modeSelect" class="opt-select">
          <option value="first">Stop when found (per hash)</option>
          <option value="all">Try all passwords (per hash)</option>
        </select>
      </div>
      <div class="opt-group">
        <span class="opt-label">Concurrency:</span>
        <select id="concSelect" class="opt-select">
          <option value="1">1 (low CPU)</option>
          <option value="2" selected>2 (balanced)</option>
          <option value="4">4 (fast)</option>
        </select>
      </div>
      <div class="opt-group">
        <span class="opt-label">Log level:</span>
        <select id="logSelect" class="opt-select">
          <option value="found">Found only</option>
          <option value="all" selected>All activity</option>
        </select>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-row">
      <button class="btn-primary" id="startBtn" onclick="startBatch()">
        <div class="spinner" id="batchSpinner"></div>
        <span id="startBtnText">â–¶ Start Batch Check</span>
      </button>
      <button class="btn-secondary" id="pauseBtn" onclick="togglePause()" disabled>â¸ Pause</button>
      <button class="btn-secondary" id="stopBtn" onclick="stopBatch()" disabled>â¹ Stop</button>
    </div>

    <!-- Progress -->
    <div id="progressSection" class="progress-section">
      <div class="progress-header">
        <span class="progress-title" id="progressLabel">Processing...</span>
        <span class="progress-pct" id="progressPct">0%</span>
      </div>
      <div class="progress-bar-bg">
        <div class="progress-bar-fill" id="progressFill"></div>
      </div>
      <div class="progress-stats">
        <div class="pstat found">âœ“ Found: <span class="num" id="statFound">0</span></div>
        <div class="pstat checked">âŠ™ Checked: <span class="num" id="statChecked">0</span></div>
        <div class="pstat remain">â—Œ Remaining: <span class="num" id="statRemain">0</span></div>
        <div class="pstat speed">âš¡ <span class="num" id="statSpeed">0</span> hash/menit</div>
        <div class="pstat eta">â± ETA: <span class="num" id="statEta">--</span></div>
      </div>
    </div>

    <!-- Summary Cards -->
    <div class="summary-grid" id="summaryGrid">
      <div class="scard s-found">
        <div class="scard-val" id="sumFound">0</div>
        <div class="scard-label">Passwords Found</div>
      </div>
      <div class="scard s-fail">
        <div class="scard-val" id="sumFail">0</div>
        <div class="scard-label">Not Matched</div>
      </div>
      <div class="scard s-total">
        <div class="scard-val" id="sumTotal">0</div>
        <div class="scard-label">Total Hashes</div>
      </div>
      <div class="scard s-speed">
        <div class="scard-val" id="sumTime">0s</div>
        <div class="scard-label">Total Time</div>
      </div>
    </div>

    <!-- Results Table -->
    <div class="results-section" id="resultsSection">
      <div class="results-toolbar">
        <span class="results-title">Results</span>
        <div class="filter-row">
          <button class="filter-btn active" onclick="filterResults('all', this)">All</button>
          <button class="filter-btn" onclick="filterResults('found', this)">âœ“ Found</button>
          <button class="filter-btn" onclick="filterResults('failed', this)">âœ— Failed</button>
          <button class="filter-btn" onclick="filterResults('error', this)">âš  Error</button>
        </div>
      </div>
      <div class="results-table-wrap">
        <table>
          <thead>
            <tr>
              <th class="td-status">Status</th>
              <th>#</th>
              <th class="td-hash">Hash</th>
              <th>Password</th>
              <th>Iterations</th>
              <th class="td-time">Time</th>
            </tr>
          </thead>
          <tbody id="resultsBody"></tbody>
        </table>
      </div>
      <div class="export-row">
        <button class="btn-export" onclick="exportCSV()">â¬‡ Export CSV</button>
        <button class="btn-export" onclick="exportFoundOnly()">â¬‡ Export Found Only</button>
        <button class="btn-export" onclick="copyFound()">â˜ Copy Passwords Found</button>
      </div>
    </div>

    <!-- Live Log -->
    <div class="log-section">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
        <span style="font-size:0.72rem;color:var(--muted);font-family:var(--mono)">LIVE LOG</span>
        <button class="btn-sm" onclick="clearLog()">Clear</button>
      </div>
      <div class="log-box" id="logBox"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TAB: SINGLE
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tab-single" class="tab-panel">
    <div class="card">
      <div class="card-head">
        <div class="card-head-title"><span class="dot"></span> Single Hash Checker</div>
      </div>
      <div class="single-form">
        <div class="form-row">
          <label class="form-label">Hash (HashCat Format)</label>
          <textarea id="singleHash" class="form-input form-textarea" rows="3"
            placeholder="$bitcoin$64$..."></textarea>
        </div>
        <div class="form-row">
          <label class="form-label">Password</label>
          <div class="pw-row">
            <input type="password" id="singlePw" class="form-input" placeholder="Enter password...">
            <button class="pw-eye" onclick="toggleSinglePw()">ğŸ‘</button>
          </div>
        </div>
        <button class="btn-primary" id="singleBtn" onclick="checkSingle()">
          <div class="spinner" id="singleSpinner"></div>
          <span id="singleBtnText">ğŸ” Check Password</span>
        </button>

        <div id="singleResult" class="single-result">
          <div class="result-title" id="singleResultTitle"></div>
          <div class="result-msg" id="singleResultMsg"></div>
          <button class="debug-toggle-btn" id="debugToggle" style="display:none" onclick="toggleDebug()">â–¶ Debug Info</button>
          <pre class="debug-pre" id="debugPre"></pre>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TAB: GUIDE
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="tab-guide" class="tab-panel">
    <div class="card">
      <div class="card-head">
        <div class="card-head-title"><span class="dot"></span> Usage Guide</div>
      </div>
      <div style="padding:24px;line-height:1.8;font-size:0.85rem;color:var(--text)">
        <h3 style="color:var(--accent);margin-bottom:12px;font-size:0.95rem">ğŸ“Œ Hash Format</h3>
        <pre style="background:#030609;border:1px solid var(--border);border-radius:8px;padding:14px;font-family:var(--mono);font-size:0.75rem;color:#58a6ff;margin-bottom:20px;white-space:pre-wrap;word-break:break-all">$bitcoin$&lt;mkHexLen&gt;$&lt;mkHex&gt;$&lt;saltHexLen&gt;$&lt;saltHex&gt;$&lt;iterations&gt;$...

Contoh:
$bitcoin$64$617c4b22fabd578e0f4d030245a0cbebd9da426fbee49c2feb885fa190b65096$16$dff2b89e4d885c28$35714$2$00$2$00
         â†‘                                                                  â†‘                  â†‘
      mkHexLen=64 chars (32 bytes)                                   saltLen=16 chars       iterations</pre>

        <h3 style="color:var(--accent);margin-bottom:12px;font-size:0.95rem">ğŸ”§ How to Extract Hash</h3>
        <pre style="background:#030609;border:1px solid var(--border);border-radius:8px;padding:14px;font-family:var(--mono);font-size:0.75rem;color:#3fb950;margin-bottom:20px">python bitcoin2john.py wallet.dat
â†’ wallet.dat:$bitcoin$64$xxxx...</pre>

        <h3 style="color:var(--accent);margin-bottom:12px;font-size:0.95rem">âš™ï¸ Verification Algorithm</h3>
        <div style="color:var(--muted2);font-size:0.83rem;margin-bottom:20px">
          <p><strong style="color:var(--text)">1. KDF (Key Derivation):</strong> SHA-512 Iterative</p>
          <pre style="background:#030609;border:1px solid var(--border);border-radius:6px;padding:10px;font-family:var(--mono);font-size:0.73rem;color:#79c0ff;margin:8px 0">hash = SHA512(password + salt)   â† round 1
hash = SHA512(hash)              â† rounds 2..N
key = hash[0..31], iv = hash[32..47]</pre>
          <p style="margin-top:12px"><strong style="color:var(--text)">2. Decryption:</strong> AES-256-CBC using key and iv from KDF</p>
          <p style="margin-top:8px"><strong style="color:var(--text)">3. Validation:</strong> 16 last bytes of decrypted result must all be <code style="color:var(--accent)">0x10</code></p>
        </div>

        <h3 style="color:var(--accent);margin-bottom:12px;font-size:0.95rem">ğŸ“‹ Batch Checking Tips</h3>
		<div style="color:var(--muted2);font-size:0.83rem;margin-bottom:20px">
        <ul style="color:var(--muted2);padding-left:20px;font-size:0.83rem">
          <li style="margin-bottom:6px">Upload .txt wordlist file directly using the "Upload .txt" button</li>
          <li style="margin-bottom:6px">Concurrency 2 is recommended â€” higher values may slow down the browser</li>
          <li style="margin-bottom:6px">Each hash with ~35000 iterations takes ~1-3 seconds per password</li>
          <li style="margin-bottom:6px">Use the Pause button if the browser feels sluggish</li>
          <li style="margin-bottom:6px">Export CSV to save all results</li>
        </ul>
		</div>
		
		<h3 style="color:var(--accent);margin-bottom:12px;font-size:0.95rem">ğŸ’° Donation</h3>
		<div style="color:var(--muted2);font-size:0.83rem;margin-bottom:20px">
		<p style="margin-top:12px"><strong style="color:var(--text)">Donate :</strong> If this tool has been useful for your education and learning, donations are greatly appreciated:</p>
		<ul style="color:var(--muted2);padding-left:20px;font-size:0.83rem">
          <li style="margin-bottom:6px"><strong style="color:var(--text)">Bitcoin (BTC) :</strong> bc1qn6t8hy8memjfzp4y3sh6fvadjdtqj64vfvlx58</li>
          <li style="margin-bottom:6px"><strong style="color:var(--text)">Ethereum (ETH) :</strong> 0x512936ca43829C8f71017aE47460820Fe703CAea</li>
          <li style="margin-bottom:6px"><strong style="color:var(--text)">Solana (SOL) :</strong> 6ZZrRmeGWMZSmBnQFWXG2UJauqbEgZnwb4Ly9vLYr7mi</li>
          <li style="margin-bottom:6px"><strong style="color:var(--text)">PayPal :</strong> syabiz@yandex.com</li>
        </ul>
		<p style="margin-top:12px">Donations will be used for developing new features, server maintenance, and documentation.</p>
		</div>
		
		<h3 style="color:var(--accent);margin-bottom:12px;font-size:0.95rem">ğŸ“ Contact</h3>
		<div style="color:var(--muted2);font-size:0.83rem;margin-bottom:20px">
		<p style="margin-top:12px">Keep in touch</p>
		<ul style="color:var(--muted2);padding-left:20px;font-size:0.83rem">
          <li style="margin-bottom:6px"><strong style="color:var(--text)">GitHub Issues :</strong> https://github.com/syabiz/Bitcoin-Hash-Wallet-Checker-HTML/issues</li>
          <li style="margin-bottom:6px"><strong style="color:var(--text)">Email :</strong> syabiz@yandex.com</li>
          <li style="margin-bottom:6px"><strong style="color:var(--text)">Twitter :</strong> @syabiz</li>
        </ul>
		</div>
		
		<h3 style="color:var(--accent);margin-bottom:12px;font-size:0.95rem">ğŸ‘‹ Greeting</h3>
		<div style="color:var(--muted2);font-size:0.83rem;margin-bottom:20px">
		<p style="margin-top:12px">Thank you for using the Bitcoin Wallet Checker Tool! ğŸš€</p>
		<ul style="color:var(--muted2);padding-left:20px;font-size:0.83rem">
          <li style="margin-bottom:6px">Made with <span class="heart">â¤ï¸</span> for Bitcoin education and learning</li>
          <li style="margin-bottom:6px"><strong style="color:var(--text)">Last Update :</strong> Last updated: February 19, 2026</li>
        </ul>
		</div>

        <div style="background:rgba(248,81,73,0.07);border:1px solid rgba(248,81,73,0.2);border-radius:8px;padding:14px;margin-top:20px;font-size:0.8rem;color:#f85149">
          âš ï¸ <strong>Important:</strong> Use only on your own wallet or with official written permission. This tool runs 100% in the browser â€” no data is sent to any server.
        </div>
      </div>
    </div>
  </div>

</div><!-- /wrap -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CORE CRYPTO â€” sama persis dengan versi single yang sudah terverifikasi
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function hexToBytes(hex) {
  hex = hex.replace(/\s+/g, '');
  const bytes = new Uint8Array(hex.length / 2);
  for (let i = 0; i < bytes.length; i++)
    bytes[i] = parseInt(hex.substr(i * 2, 2), 16);
  return bytes;
}

function uint8ToWordArray(u8) {
  const words = [];
  for (let i = 0; i < u8.length; i += 4)
    words.push(((u8[i]||0)<<24)|((u8[i+1]||0)<<16)|((u8[i+2]||0)<<8)|(u8[i+3]||0));
  return CryptoJS.lib.WordArray.create(words, u8.length);
}

function wordArrayToUint8(wa) {
  const bytes = new Uint8Array(wa.sigBytes);
  for (let i = 0; i < wa.sigBytes; i++)
    bytes[i] = (wa.words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;
  return bytes;
}

function parseBitcoinHash(hashStr) {
  hashStr = hashStr.trim();
  let prefix = '';
  if (hashStr.startsWith('$bitcoin$'))       prefix = '$bitcoin$';
  else if (hashStr.startsWith('$litecoin$')) prefix = '$litecoin$';
  else throw new Error('Not a valid $bitcoin$ or $litecoin$ format');

  const parts = hashStr.slice(prefix.length).split('$');
  if (parts.length < 5) throw new Error(`Incomplete hash (${parts.length} parts)`);

  const mkHexLen   = parseInt(parts[0]);
  const masterKey  = parts[1];
  const saltHexLen = parseInt(parts[2]);
  const saltHex    = parts[3];
  const iterations = parseInt(parts[4]);

  if (isNaN(mkHexLen)||isNaN(saltHexLen)||isNaN(iterations))
    throw new Error('Invalid numeric values');
  if (masterKey.length !== mkHexLen)
    throw new Error(`mkHex length ${masterKey.length}, expected ${mkHexLen}`);
  if (saltHex.length !== saltHexLen)
    throw new Error(`saltHex length ${saltHex.length}, expected ${saltHexLen}`);
  if (masterKey.length < 64)
    throw new Error('mkHex too short (min 64 chars)');

  return { masterKeyHex: masterKey, saltHex, iterations };
}

async function deriveKeyBitcoinSHA512(password, saltBytes, iterations) {
  const passBytes = new TextEncoder().encode(password);
  const combined  = new Uint8Array(passBytes.length + saltBytes.length);
  combined.set(passBytes, 0);
  combined.set(saltBytes, passBytes.length);

  let hashBuf = await crypto.subtle.digest('SHA-512', combined);
  for (let i = 1; i < iterations; i++)
    hashBuf = await crypto.subtle.digest('SHA-512', hashBuf);

  return new Uint8Array(hashBuf);
}

async function checkPassword(hashStr, password) {
  // Returns: { found: bool, error: string|null, timeMs: number }
  const t0 = performance.now();
  try {
    const parsed     = parseBitcoinHash(hashStr);
    const saltBytes  = hexToBytes(parsed.saltHex);
    const mkBytes    = hexToBytes(parsed.masterKeyHex);
    const derived    = await deriveKeyBitcoinSHA512(password, saltBytes, parsed.iterations);

    const key    = derived.slice(0, 32);
    const iv     = derived.slice(32, 48);
    const cipher = mkBytes.slice(0, 32);

    const dec = CryptoJS.AES.decrypt(
      { ciphertext: uint8ToWordArray(cipher) },
      uint8ToWordArray(key),
      { iv: uint8ToWordArray(iv), mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.NoPadding }
    );
    const decBytes = wordArrayToUint8(dec);

    // Validasi ketat: semua 16 byte terakhir harus 0x10
    const last    = decBytes[decBytes.length - 1];
    let   isValid = (last === 0x10);
    if (isValid) {
      for (let i = decBytes.length - 16; i < decBytes.length; i++) {
        if (decBytes[i] !== 0x10) { isValid = false; break; }
      }
    }
    return { found: isValid, error: null, timeMs: performance.now() - t0, iterations: parsed.iterations };
  } catch (e) {
    return { found: false, error: e.message, timeMs: performance.now() - t0, iterations: 0 };
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BATCH STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let batchRunning  = false;
let batchPaused   = false;
let batchStop     = false;
let batchResults  = [];
let batchStartTime = 0;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COUNTER HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function getHashes() {
  return document.getElementById('hashList').value
    .split('\n')
    .map(l => l.trim())
    .filter(l => l.startsWith('$bitcoin$') || l.startsWith('$litecoin$'));
}

function getWords() {
  return document.getElementById('wordList').value
    .split('\n')
    .map(l => l.trim())
    .filter(l => l.length > 0);
}

function updateCounters() {
  document.getElementById('hashCount').textContent = getHashes().length;
  document.getElementById('wordCount').textContent = getWords().length;
}

document.getElementById('hashList').addEventListener('input', updateCounters);
document.getElementById('wordList').addEventListener('input', updateCounters);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BATCH ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

async function startBatch() {
  const hashes = getHashes();
  const words  = getWords();

  if (!hashes.length) { addLog('âš  No valid hashes found.', 'warn'); return; }
  if (!words.length)  { addLog('âš  Wordlist is empty.', 'warn'); return; }

  // Reset state
  batchRunning   = true;
  batchPaused    = false;
  batchStop      = false;
  batchResults   = [];
  batchStartTime = performance.now();

  // UI
  document.getElementById('startBtn').disabled    = true;
  document.getElementById('pauseBtn').disabled    = false;
  document.getElementById('stopBtn').disabled     = false;
  document.getElementById('batchSpinner').style.display = 'block';
  document.getElementById('startBtnText').textContent   = 'Processing...';

  document.getElementById('progressSection').classList.add('visible');
  document.getElementById('resultsSection').classList.add('visible');
  document.getElementById('summaryGrid').classList.remove('visible');
  document.getElementById('resultsBody').innerHTML = '';

  const stopOnFirst  = document.getElementById('modeSelect').value === 'first';
  const concurrency  = parseInt(document.getElementById('concSelect').value);

  addLog(`â–¶ Start: ${hashes.length} hashes Ã— ${words.length} passwords = ${hashes.length * words.length} combinations`, 'info');
  addLog(`  Mode: ${stopOnFirst ? 'stop when found' : 'try all'} | Concurrency: ${concurrency}`, 'info');

  // Stats
  let totalChecked = 0;
  let totalFound   = 0;
  const totalOps   = hashes.length * words.length;

  // Process each hash
  for (let hIdx = 0; hIdx < hashes.length; hIdx++) {
    if (batchStop) break;

    const hashStr = hashes[hIdx];
    let hashResult = { hash: hashStr, status: 'failed', password: null, timeMs: 0, iterations: 0, error: null, idx: hIdx + 1 };

    // Add pending row
    addTableRow(hashResult, true);
    updateTableRow(hashResult, 'checking');

    const rowStart = performance.now();
    let found = false;

    // Process words in chunks of `concurrency`
    for (let wIdx = 0; wIdx < words.length && !found; wIdx += concurrency) {
      if (batchStop) break;

      // Pause support
      while (batchPaused && !batchStop) {
        await sleep(200);
      }
      if (batchStop) break;

      const chunk = words.slice(wIdx, wIdx + concurrency);
      const promises = chunk.map(pw => checkPassword(hashStr, pw).then(r => ({ ...r, pw })));
      const results  = await Promise.all(promises);

      for (const r of results) {
        totalChecked++;
        if (r.found) {
          found = true;
          totalFound++;
          hashResult.status     = 'found';
          hashResult.password   = r.pw;
          hashResult.timeMs     = performance.now() - rowStart;
          hashResult.iterations = r.iterations;
          addLog(`âœ“ FOUND! Hash #${hIdx+1} â†’ "${r.pw}"`, 'found');
          break;
        }
        if (r.error && !hashResult.error) {
          hashResult.error = r.error;
        }
      }

      // Update progress
      updateProgress(totalChecked, totalFound, totalOps, hashes.length - (hIdx+1));
      updateTableRow(hashResult, found ? 'found' : 'checking');
      await sleep(0); // yield to browser
    }

    if (!found) {
      if (hashResult.error) {
        hashResult.status = 'error';
        addLog(`âš  Error hash #${hIdx+1}: ${hashResult.error}`, 'warn');
      } else {
        hashResult.status = 'failed';
        if (document.getElementById('logSelect').value === 'all')
          addLog(`âœ— Not found: Hash #${hIdx+1}`, 'fail');
      }
      hashResult.timeMs     = performance.now() - rowStart;
    }

    updateTableRow(hashResult, hashResult.status);
    batchResults.push(hashResult);
  }

  // Done
  batchRunning = false;
  finishBatch(totalFound, batchResults.length);
}

function updateProgress(checked, found, total, remaining) {
  const pct     = total > 0 ? Math.min(100, Math.round(checked / total * 100)) : 0;
  const elapsed = (performance.now() - batchStartTime) / 1000;
  const rate    = elapsed > 0 ? Math.round(checked / elapsed * 60) : 0;
  const eta     = rate > 0 ? formatEta((total - checked) / rate * 60) : '--';

  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressPct').textContent  = pct + '%';
  document.getElementById('statFound').textContent    = found;
  document.getElementById('statChecked').textContent  = checked;
  document.getElementById('statRemain').textContent   = remaining;
  document.getElementById('statSpeed').textContent    = rate;
  document.getElementById('statEta').textContent      = eta;
  document.getElementById('progressLabel').textContent = `Processing... ${checked}/${total} combinations`;
}

function finishBatch(found, total) {
  const elapsed = ((performance.now() - batchStartTime) / 1000).toFixed(1);

  document.getElementById('startBtn').disabled  = false;
  document.getElementById('pauseBtn').disabled  = true;
  document.getElementById('stopBtn').disabled   = true;
  document.getElementById('batchSpinner').style.display = 'none';
  document.getElementById('startBtnText').textContent   = 'â–¶ Start Batch Check';

  document.getElementById('progressLabel').textContent = batchStop
    ? `â¹ Stopped after ${elapsed}s`
    : `âœ… Completed in ${elapsed}s`;
  document.getElementById('progressFill').style.width = '100%';
  document.getElementById('progressPct').textContent  = '100%';

  // Summary cards
  document.getElementById('sumFound').textContent = found;
  document.getElementById('sumFail').textContent  = total - found;
  document.getElementById('sumTotal').textContent = total;
  document.getElementById('sumTime').textContent  = elapsed + 's';
  document.getElementById('summaryGrid').classList.add('visible');

  addLog(`â”€â”€â”€ Done: ${found}/${total} found in ${elapsed}s â”€â”€â”€`, 'info');
}

function togglePause() {
  batchPaused = !batchPaused;
  document.getElementById('pauseBtn').textContent = batchPaused ? 'â–¶ Resume' : 'â¸ Pause';
  addLog(batchPaused ? 'â¸ Paused' : 'â–¶ Resumed', 'info');
}

function stopBatch() {
  batchStop = true;
  batchPaused = false;
  addLog('â¹ Stopped by user.', 'warn');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TABLE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const rowMap = {};

function addTableRow(result, pending) {
  const tbody = document.getElementById('resultsBody');
  const tr    = document.createElement('tr');
  tr.id       = `row-${result.idx}`;
  tr.dataset.status = 'checking';
  tr.innerHTML = `
    <td class="td-status"><span class="status-pill checking">â³ Checking...</span></td>
    <td>${result.idx}</td>
    <td class="td-hash"><span class="hash-short" title="${result.hash}">${result.hash.substring(0,60)}...</span></td>
    <td class="td-password">â€”</td>
    <td>â€”</td>
    <td class="td-time">â€”</td>
  `;
  tbody.appendChild(tr);
  rowMap[result.idx] = tr;
  tr.scrollIntoView({ block: 'nearest' });
}

function updateTableRow(result, status) {
  const tr = rowMap[result.idx];
  if (!tr) return;

  tr.dataset.status = status;

  const pillMap = {
    found:    `<span class="status-pill found">âœ“ FOUND</span>`,
    failed:   `<span class="status-pill failed">âœ— Failed</span>`,
    error:    `<span class="status-pill error">âš  Error</span>`,
    checking: `<span class="status-pill checking">â³ Checking...</span>`,
  };

  tr.cells[0].innerHTML = pillMap[status] || pillMap.checking;
  tr.cells[3].textContent = result.password || (status === 'error' ? result.error?.substring(0,30) : 'â€”');
  tr.cells[3].style.color = status === 'found' ? 'var(--green)' : (status === 'error' ? 'var(--yellow)' : 'var(--muted)');
  tr.cells[4].textContent = result.iterations || 'â€”';
  tr.cells[5].textContent = result.timeMs > 0 ? (result.timeMs / 1000).toFixed(2) + 's' : 'â€”';
}

function filterResults(type, btn) {
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  document.querySelectorAll('#resultsBody tr').forEach(tr => {
    tr.style.display = (type === 'all' || tr.dataset.status === type) ? '' : 'none';
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function addLog(msg, type = 'info') {
  const box  = document.getElementById('logBox');
  const line = document.createElement('div');
  const ts   = new Date().toTimeString().slice(0, 8);
  line.className   = `log-line ${type}`;
  line.textContent = `[${ts}] ${msg}`;
  box.appendChild(line);
  box.scrollTop = box.scrollHeight;

  // Limit log lines
  while (box.children.length > 500) box.removeChild(box.firstChild);
}

function clearLog() {
  document.getElementById('logBox').innerHTML = '';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXPORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function exportCSV() {
  if (!batchResults.length) return;
  const header = 'No,Status,Hash,Password,Iterations,Time(s)\n';
  const rows   = batchResults.map(r =>
    `${r.idx},${r.status},"${r.hash}","${r.password || ''}",${r.iterations},${(r.timeMs/1000).toFixed(3)}`
  ).join('\n');
  downloadFile('bitcoin_batch_results.csv', header + rows, 'text/csv');
}

function exportFoundOnly() {
  const found = batchResults.filter(r => r.status === 'found');
  if (!found.length) { addLog('No results found to export.', 'warn'); return; }
  const header = 'No,Hash,Password,Iterations,Time(s)\n';
  const rows   = found.map(r =>
    `${r.idx},"${r.hash}","${r.password}",${r.iterations},${(r.timeMs/1000).toFixed(3)}`
  ).join('\n');
  downloadFile('bitcoin_found_passwords.csv', header + rows, 'text/csv');
}

function copyFound() {
  const found = batchResults.filter(r => r.status === 'found');
  if (!found.length) { addLog('No passwords found.', 'warn'); return; }
  const text = found.map(r => `${r.hash}\t${r.password}`).join('\n');
  navigator.clipboard.writeText(text).then(() => addLog(`âœ“ ${found.length} password(s) copied to clipboard.`, 'found'));
}

function downloadFile(filename, content, mime) {
  const a   = document.createElement('a');
  a.href    = URL.createObjectURL(new Blob([content], { type: mime }));
  a.download = filename;
  a.click();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SINGLE CHECK TAB
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

async function checkSingle() {
  const hashStr  = document.getElementById('singleHash').value.trim();
  const password = document.getElementById('singlePw').value;
  const resDiv   = document.getElementById('singleResult');
  const debugPre = document.getElementById('debugPre');
  const dbgToggle = document.getElementById('debugToggle');

  resDiv.style.display = 'none';
  debugPre.style.display = 'none';
  dbgToggle.style.display = 'none';

  if (!hashStr || !password) {
    showSingleResult('warning', 'âš ï¸ Empty Input', 'Please enter a hash and password first.');
    return;
  }

  document.getElementById('singleSpinner').style.display = 'block';
  document.getElementById('singleBtnText').textContent   = 'Processing...';
  document.getElementById('singleBtn').disabled          = true;
  await sleep(20);

  const dbg = [];
  try {
    const parsed    = parseBitcoinHash(hashStr);
    const saltBytes = hexToBytes(parsed.saltHex);
    const mkBytes   = hexToBytes(parsed.masterKeyHex);

    dbg.push(`KDF          : SHA-512 Iterative (Bitcoin Core)`);
    dbg.push(`Password     : ${password}`);
    dbg.push(`Salt         : ${parsed.saltHex} (${saltBytes.length} bytes)`);
    dbg.push(`Iterations   : ${parsed.iterations}`);
    dbg.push(`MasterKey    : ${parsed.masterKeyHex}`);
    dbg.push(`${'â”€'.repeat(56)}`);

    const t0      = performance.now();
    const derived = await deriveKeyBitcoinSHA512(password, saltBytes, parsed.iterations);
    const elapsed = ((performance.now() - t0) / 1000).toFixed(3);

    const key  = derived.slice(0, 32);
    const iv   = derived.slice(32, 48);
    const cipher = mkBytes.slice(0, 32);

    dbg.push(`KDF Time     : ${elapsed}s`);
    dbg.push(`Key (32b)    : ${Array.from(key).map(b=>b.toString(16).padStart(2,'0')).join('')}`);
    dbg.push(`IV  (16b)    : ${Array.from(iv).map(b=>b.toString(16).padStart(2,'0')).join('')}`);
    dbg.push(`Ciphertext   : ${Array.from(cipher).map(b=>b.toString(16).padStart(2,'0')).join('')}`);

    const dec      = CryptoJS.AES.decrypt(
      { ciphertext: uint8ToWordArray(cipher) }, uint8ToWordArray(key),
      { iv: uint8ToWordArray(iv), mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.NoPadding }
    );
    const decBytes = wordArrayToUint8(dec);

    dbg.push(`Decrypted    : ${Array.from(decBytes).map(b=>b.toString(16).padStart(2,'0')).join('')}`);

    const last    = decBytes[decBytes.length - 1];
    let   isValid = (last === 0x10);
    if (isValid)
      for (let i = decBytes.length-16; i < decBytes.length; i++)
        if (decBytes[i] !== 0x10) { isValid = false; break; }

    dbg.push(`Padding byte : 0x${last.toString(16).padStart(2,'0')} (${last})`);
    dbg.push(`Padding valid: ${isValid ? 'âœ“ YA (0x10 Ã— 16) â€” PASSWORD BENAR!' : `âœ— TIDAK (0x${last.toString(16).padStart(2,'0')}) â€” Password salah`}`);

    debugPre.textContent = dbg.join('\n');
    dbgToggle.style.display = 'inline-block';

    if (isValid)
      showSingleResult('success', 'âœ… Password Correct!', `"${password}" matches this hash.`);
    else
      showSingleResult('error', 'âŒ Wrong Password', 'Padding 0x10Ã—16 not satisfied. Password does not match.');

  } catch(e) {
    debugPre.textContent = dbg.join('\n') + '\n\nError: ' + e.message;
    dbgToggle.style.display = 'inline-block';
    showSingleResult('warning', 'âš ï¸ Error', e.message);
  } finally {
    document.getElementById('singleSpinner').style.display = 'none';
    document.getElementById('singleBtnText').textContent   = 'ğŸ” Check Password';
    document.getElementById('singleBtn').disabled          = false;
  }
}

function showSingleResult(type, title, msg) {
  const d = document.getElementById('singleResult');
  d.className = `single-result ${type}`;
  d.style.display = 'block';
  document.getElementById('singleResultTitle').textContent = title;
  document.getElementById('singleResultMsg').textContent   = msg;
}

function toggleSinglePw() {
  const inp = document.getElementById('singlePw');
  inp.type  = inp.type === 'password' ? 'text' : 'password';
}

function toggleDebug() {
  const pre    = document.getElementById('debugPre');
  const toggle = document.getElementById('debugToggle');
  const show   = pre.style.display !== 'block';
  pre.style.display    = show ? 'block' : 'none';
  toggle.textContent   = show ? 'â–¼ Hide Debug' : 'â–¶ Debug Info';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TAB SWITCHING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function switchTab(name) {
  document.querySelectorAll('.tab-btn').forEach((b, i) => {
    b.classList.toggle('active', ['batch','single','guide'][i] === name);
  });
  document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  document.getElementById(`tab-${name}`).classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SAMPLE DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function loadSampleHashes() {
  document.getElementById('hashList').value =
`$bitcoin$64$ff4eb1d017921e0c7023da7e17aa72bd5f11f9025c844865665932125f79f465$16$6b8207637fc796a0$37698$2$00$2$00
$bitcoin$64$617c4b22fabd578e0f4d030245a0cbebd9da426fbee49c2feb885fa190b65096$16$dff2b89e4d885c28$35714$2$00$2$00`;
  updateCounters();
}

function loadSampleWords() {
  document.getElementById('wordList').value =
`password
123456
bitcoin
wallet
2315
satoshi
crypto2024
1234567890
qwerty
abc123`;
  updateCounters();
}

function clearHashes() { document.getElementById('hashList').value = ''; updateCounters(); }
function clearWords()  { document.getElementById('wordList').value = ''; updateCounters(); }

function loadWordlistFile(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    document.getElementById('wordList').value = e.target.result;
    updateCounters();
    addLog(`âœ“ File "${file.name}" loaded (${e.target.result.split('\n').filter(l=>l.trim()).length} baris)`, 'info');
  };
  reader.readAsText(file);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UTILS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }

function formatEta(seconds) {
  if (seconds < 60)  return Math.round(seconds) + 's';
  if (seconds < 3600) return Math.round(seconds/60) + 'm';
  return (seconds/3600).toFixed(1) + 'h';
}
</script>
</body>
</html>
